cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- new_table_9[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- new_table_9[, col_2][61:length(new_table_9[, col_2])]
cc = rep(0,121)
for (i in -60:60){
if (i>=0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}}
plot(1:121, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- new_table_9[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- new_table_9[, col_2][61:length(new_table_9[, col_2])]
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}}
plot(1:121, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- new_table_9[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- new_table_9[, col_2][61:length(new_table_9[, col_2])]
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i-1)])}}
plot(1:121, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- new_table_9[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- new_table_9[, col_2][61:length(new_table_9[, col_2])]
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}}
plot(1:121, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- new_table_9[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- new_table_9[, col_2][61:length(new_table_9[, col_2])]
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(2-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i-1)])}}
plot(1:121, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- new_table_9[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- new_table_9[, col_2][61:length(new_table_9[, col_2])]
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(2-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i+1)])}}
plot(1:121, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- new_table_9[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- new_table_9[, col_2][61:length(new_table_9[, col_2])]
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}}
plot(1:121, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- new_table_9[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- new_table_9[, col_2][61:length(new_table_9[, col_2])]
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i)]),(new_col_2[(i-1):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}}
plot(1:121, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- new_table_9[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- new_table_9[, col_2][61:length(new_table_9[, col_2])]
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i)]),(new_col_2[(i+1):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}}
plot(1:121, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- new_table_9[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- new_table_9[, col_2][61:length(new_table_9[, col_2])]
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(0-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i-1)])}}
plot(1:121, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- new_table_9[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- new_table_9[, col_2][61:length(new_table_9[, col_2])]
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}}
plot(1:121, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- new_table_9[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- new_table_9[, col_2][61:length(new_table_9[, col_2])]
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}
plot(i, cc)}
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- new_table_9[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- new_table_9[, col_2][61:length(new_table_9[, col_2])]
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}}
plot(-60:60, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- new_table_9[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- new_table_9[, col_2][61:length(new_table_9[, col_2])]
new_table_9A <- rbind(new_col_1,new_col_2)
print(new_table_9A)
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}}
plot(-60:60, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- data_for_plot_country[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- data_for_plot_country[, col_2][61:length(new_table_9[, col_2])]
new_table_9A <- rbind(new_col_1,new_col_2)
print(new_table_9A)
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}}
plot(-60:60, cc)
return(cc)
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- data_for_plot_country[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- data_for_plot_country[, col_2][61:length(new_table_9[, col_2])]
new_table_9A <- rbind(new_col_1,new_col_2)
print(new_table_9A)
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}}
plot(-60:60, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
=
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- data_for_plot_country[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- data_for_plot_country[, col_2][61:length(new_table_9[, col_2])]
new_table_9A <- rbind(new_col_1,new_col_2)
print(new_table_9A)
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i+1)]),(new_col_2[(i):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}}
plot(-60:60, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- data_for_plot_country[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- data_for_plot_country[, col_2][61:length(new_table_9[, col_2])]
new_table_9A <- rbind(new_col_1,new_col_2)
print(new_table_9A)
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i)]),(new_col_2[(i+1):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}}
plot(-60:60, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- data_for_plot_country[, col_1][1:(length(new_table_9[, col_2])-60)]
new_col_2 <- data_for_plot_country[, col_2][61:length(new_table_9[, col_2])]
new_table_9A <- rbind(new_col_1,new_col_2)
print(new_table_9A)
cc = rep(0,121)
for (i in -60:60){
if (i>=0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i)]),(new_col_2[(i+1):(length(new_col_1))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_1))+i)])}}
plot(-60:60, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
new_col_1 <- data_for_plot_country[, col_1][1:(length(new_table_9[, col_1])-60)]
new_col_2 <- data_for_plot_country[, col_2][61:length(new_table_9[, col_2])]
new_table_9A <- rbind(new_col_1,new_col_2)
print(new_table_9A)
cc = rep(0,121)
for (i in -60:60){
if (i>=0){
cc[60+i] =cor((new_col_1[1:((length(new_col_1))-i)]),(new_col_2[(i+1):(length(new_col_2))]))}
else{cc[61+i] =cor(new_col_1[(1-i):(length(new_col_1))],new_col_2[1:((length(new_col_2))+i)])}}
plot(-60:60, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9A)
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =
cor((new_table_9[, col_1][1:((length(new_table_9[, col_2]))-i+1)]),(new_table_9[, col_2][(i):(length(new_table_9[, col_2]))]))}
else{cc[61+i] =cor(new_table_9[, col_1][(1-i):(length(new_table_9[, col_1]))],new_table_9[, col_2][1:((length(new_table_9[, col_2]))+i)])}}
plot(-60:60, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =
cor((new_table_9[, col_1][1:((length(new_table_9[, col_2]))-i+1)]),(new_table_9[, col_2][(i):(length(new_table_9[, col_2]))]))}
else{cc[61+i] =cor(new_table_9[, col_1][(1-i):(length(new_table_9[, col_1]))],new_table_9[, col_2][1:((length(new_table_9[, col_2]))+i)])}}
plot(-60:60, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =
cor((new_table_9[, col_1][1:((length(new_table_9[, col_2]))-i+1)]),(new_table_9[, col_2][(i):(length(new_table_9[, col_2]))]))}
else{cc[61+i] =cor((new_table_9[, col_1][(1-i):(length(new_table_9[, col_1]))]%>%replace_na(0)),(new_table_9[, col_2][1:((length(new_table_9[, col_2]))+i)]%>%replace_na(0)))}}
plot(-60:60, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =
cor((new_table_9[, col_1][1:((length(new_table_9[, col_2]))-i+1)]),(new_table_9[, col_2]%>%replace_na(0)[(i):(length(new_table_9[, col_2]))]%>%replace_na(0)))}
else{cc[61+i] =cor(new_table_9[, col_1][(1-i):(length(new_table_9[, col_1]))]%>%replace_na(0),new_table_9[, col_2][1:((length(new_table_9[, col_2]))+i)]%>%replace_na(0))}}
plot(-60:60, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =
cor((new_table_9[, col_1][1:((length(new_table_9[, col_2]))-i+1)]%>%replace_na(0)),(new_table_9[, col_2][(i):(length(new_table_9[, col_2]))]%>%replace_na(0)))}
else{cc[61+i] =cor(new_table_9[, col_1][(1-i):(length(new_table_9[, col_1]))]%>%replace_na(0),new_table_9[, col_2][1:((length(new_table_9[, col_2]))+i)]%>%replace_na(0))}}
plot(-60:60, cc)
return(cc)
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
=
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =
cor((new_table_9[, col_1][1:((length(new_table_9[, col_2]))-i+1)]%>%replace_na(0)),(new_table_9[, col_2][(i):(length(new_table_9[, col_2]))]%>%replace_na(0)))}
else{cc[61+i] =cor(new_table_9[, col_1][(1-i):(length(new_table_9[, col_1]))]%>%replace_na(0),new_table_9[, col_2][1:((length(new_table_9[, col_2]))+i)]%>%replace_na(0))}}
plot(-60:60, cc)
return(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
print(new_table_9)
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =
cor((new_table_9[, col_1][1:((length(new_table_9[, col_2]))-i+1)]%>%replace_na(0)),(new_table_9[, col_2][(i):(length(new_table_9[, col_2]))]%>%replace_na(0)))}
else{cc[61+i] =cor(new_table_9[, col_1][(1-i):(length(new_table_9[, col_1]))]%>%replace_na(0),new_table_9[, col_2][1:((length(new_table_9[, col_2]))+i)]%>%replace_na(0))}}
plot(-60:60, cc)
print(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =
cor((new_table_9[, col_1][1:((length(new_table_9[, col_2]))-i+1)]%>%replace_na(0)),(new_table_9[, col_2][(i):(length(new_table_9[, col_2]))]%>%replace_na(0)))}
else{cc[61+i] =cor(new_table_9[, col_1][(1-i):(length(new_table_9[, col_1]))]%>%replace_na(0),new_table_9[, col_2][1:((length(new_table_9[, col_2]))+i)]%>%replace_na(0))}}
plot(-60:60, cc)
print(cc)
}
print(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
plot(-60:60, cros_cor(Data, "Canada", "new_cases", "new_deaths"))
max(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
cros_cor <- function(data,country, col_1, col_2){
data_for_plot_country <- filter(data ,(location == country))
new_table_9 <- select(data_for_plot_country,location,col_1,col_2)
cc = rep(0,121)
for (i in -60:60){
if (i>0){
cc[60+i] =
cor((new_table_9[, col_1][1:((length(new_table_9[, col_2]))-i+1)]%>%replace_na(0)),(new_table_9[, col_2][(i):(length(new_table_9[, col_2]))]%>%replace_na(0)))}
else{cc[61+i] =cor(new_table_9[, col_1][(1-i):(length(new_table_9[, col_1]))]%>%replace_na(0),new_table_9[, col_2][1:((length(new_table_9[, col_2]))+i)]%>%replace_na(0))}}
return(cc)
}
plot(-60:60, cros_cor(Data, "Canada", "new_cases", "new_deaths"))
max(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
plot(-60:60, cros_cor(Data, "Canada", "new_cases", "new_deaths"))
which.max(cros_cor(Data, "Canada", "new_cases", "new_deaths"))
plot(-60:60, cros_cor(Data, "Canada", "new_cases", "new_deaths"))
which.max(cros_cor(Data, "Canada", "new_cases", "new_deaths")) - 60
p_9 <- plot(-60:60, cros_cor(Data, "Canada", "new_cases", "new_deaths"))
which.max(cros_cor(Data, "Canada", "new_cases", "new_deaths")) - 60
p_9 +
geom_point(data = New_Data_Q_10_A[which.max(cros_cor(Data, "Canada", "new_cases", "new_deaths")),], color = "red")
p_9 <- plot(-60:60, cros_cor(Data, "Canada", "new_cases", "new_deaths"))
which.max(cros_cor(Data, "Canada", "new_cases", "new_deaths")) - 60
p_9 +
geom_point(data = cros_cor(Data, "Canada", "new_cases", "new_deaths")[which.max(cros_cor(Data, "Canada", "new_cases", "new_deaths")),], color = "red")
p_9 <- plot(-60:60, cros_cor(Data, "Canada", "new_cases", "new_deaths"))
which.max(cros_cor(Data, "Canada", "new_cases", "new_deaths")) - 60
p_9 +
geom_point(data = cros_cor(Data, "Canada", "new_cases", "new_deaths")[which.max(cros_cor(Data, "Canada", "new_cases", "new_deaths"))], color = "red")
p_9 <- plot(-60:60, cros_cor(Data, "Canada", "new_cases", "new_deaths"),col=ifelse(x==max(cros_cor(Data, "Canada", "new_cases", "new_deaths")), "red", "black"))
p_9 <- plot(-60:60, cros_cor(Data, "Canada", "new_cases", "new_deaths"))
pnt <- identify(x, y, plot = F)
pnt <- identify(-60:60, cros_cor(Data, "Canada", "new_cases", "new_deaths"), plot = F)
plot(-60:60, cros_cor(Data, "Canada", "new_cases", "new_deaths"))
pnt <- identify(-60:60, cros_cor(Data, "Canada", "new_cases", "new_deaths"), plot = F)
plot(-60:60, cros_cor(Data, "Canada", "new_cases", "new_deaths"))
plot(-60:60, cros_cor(Data, "Canada", "new_cases", "new_deaths"))
NewData_B1 <-  NewData_2[complete.cases(NewData_2$new_cases),]
NewData_B2 <-  NewData_B1[complete.cases(NewData_B1$new_deaths),]
group_loc <- group_by(NewData_B2, location)
group_summ <- summarize(group_loc, max_new_cases_date = as.Date(Date[which.max(new_cases)]),max_new_deaths_date = as.Date(Date[which.max(new_deaths)]))
new_table <- merge(NewData_4, group_summ,
by.x ="location" , by.y ="location" ,
all.x = TRUE, all.y =TRUE )
final_table <-  new_table[complete.cases(new_table$max_new_cases_date),]
final_table_5B <-  final_table[complete.cases(final_table$max_new_deaths_date),]
ggplot(data = final_table_5B, aes(x = max_new_cases_date, y = max_new_deaths_date),) +
geom_point(color='red') +
geom_smooth(method = "lm", se = FALSE)
reg_5B = lm(as.numeric(final_table_5B$max_new_cases_date)~as.numeric(final_table_5B$max_new_deaths_date))
sum_5B <- summary(reg_5B)
print(intercept <- sum_5B$coefficients[1])
print(slope <- sum_5B$coefficients[2])
print as.Date(intercept)
print (as.Date(intercept))
NewData_B1 <-  NewData_2[complete.cases(NewData_2$new_cases),]
NewData_B2 <-  NewData_B1[complete.cases(NewData_B1$new_deaths),]
group_loc <- group_by(NewData_B2, location)
group_summ <- summarize(group_loc, max_new_cases_date = as.Date(Date[which.max(new_cases)]),max_new_deaths_date = as.Date(Date[which.max(new_deaths)]))
new_table <- merge(NewData_4, group_summ,
by.x ="location" , by.y ="location" ,
all.x = TRUE, all.y =TRUE )
final_table <-  new_table[complete.cases(new_table$max_new_cases_date),]
final_table_5B <-  final_table[complete.cases(final_table$max_new_deaths_date),]
ggplot(data = final_table_5B, aes(x = max_new_cases_date, y = max_new_deaths_date),) +
geom_point(color='red') +
geom_smooth(method = "lm", se = FALSE)
reg_5B = lm(as.character(final_table_5B$max_new_cases_date)~as.character(final_table_5B$max_new_deaths_date))
reg_5B = lm((final_table_5B$max_new_cases_date)~(final_table_5B$max_new_deaths_date))
print(reg_5B)
NewData_B1 <-  NewData_2[complete.cases(NewData_2$new_cases),]
NewData_B2 <-  NewData_B1[complete.cases(NewData_B1$new_deaths),]
group_loc <- group_by(NewData_B2, location)
group_summ <- summarize(group_loc, max_new_cases_date = as.Date(Date[which.max(new_cases)]),max_new_deaths_date = as.Date(Date[which.max(new_deaths)]))
new_table <- merge(NewData_4, group_summ,
by.x ="location" , by.y ="location" ,
all.x = TRUE, all.y =TRUE )
final_table <-  new_table[complete.cases(new_table$max_new_cases_date),]
final_table_5B <-  final_table[complete.cases(final_table$max_new_deaths_date),]
ggplot(data = final_table_5B, aes(x = max_new_cases_date, y = max_new_deaths_date),) +
geom_point(color='red') +
geom_smooth(method = "lm", se = FALSE)
reg_5B = lm(as.numeric(final_table_5B$max_new_cases_date)~as.numeric(final_table_5B$max_new_deaths_date))
sum_5B <- summary(reg_5B)
print(intercept <- sum_5B$coefficients[1])
print(slope <- sum_5B$coefficients[2])
