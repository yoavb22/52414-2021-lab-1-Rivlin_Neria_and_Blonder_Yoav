summ_4 <- summarize(group_4, mean=mean(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
table_4A = table_4[complete.cases(table_4$mean), ]
new_table_D4 <- left_join(data, table_4A ,by=c("location"="continent" ,"Date"="Date"))
print(new_table_D4["col", ])}
data_4B = Data[complete.cases(Data$new_tests_per_thousand), ]
complete_columns(data_4B,"new_tests_per_thousand")
complete_columns <- function(data,col){
group_4 <- group_by(data,Date,continent)
summ_4 <- summarize(group_4, mean=mean(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
table_4A = table_4[complete.cases(table_4$mean), ]
new_table_D4 <- left_join(data, table_4A ,by=c("location"="continent" ,"Date"="Date"))
print(new_table_D4[col, ])}
data_4B = Data[complete.cases(Data$new_tests_per_thousand), ]
complete_columns(data_4B,"new_tests_per_thousand")
complete_columns <- function(data,col){
group_4 <- group_by(data,Date,continent)
summ_4 <- summarize(group_4, mean=mean(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
table_4A = table_4[complete.cases(table_4$mean), ]
new_table_D4 <- left_join(data, table_4A ,by=c("location"="continent" ,"Date"="Date"))
print(new_table_D4[, col])}
data_4B = Data[complete.cases(Data$new_tests_per_thousand), ]
complete_columns(data_4B,"new_tests_per_thousand")
complete_columns <- function(data,col){
group_4 <- group_by(data,Date,continent)
summ_4 <- summarize(group_4, mean=mean(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
table_4A = table_4[complete.cases(table_4$mean), ]
new_table_D4 <- left_join(data, table_4A ,by=c("location"="continent" ,"Date"="Date"))
new_table_D4$col <- coalesce(new_table_D4[, col], new_table_D4$mean)
print(new_table_D4)}
data_4B = Data[complete.cases(Data$new_tests_per_thousand), ]
complete_columns(data_4B,"new_tests_per_thousand")
complete_columns <- function(data,col){
group_4 <- group_by(data,Date,continent)
summ_4 <- summarize(group_4, mean=mean(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
table_4A = table_4[complete.cases(table_4$mean), ]
new_table_D4 <- left_join(data, table_4A ,by=c("location"="continent" ,"Date"="Date"))
new_table_D4[, col] <- coalesce(new_table_D4[, col], new_table_D4$mean)
print(new_table_D4)}
data_4B = Data[complete.cases(Data$new_tests_per_thousand), ]
complete_columns(data_4B,"new_tests_per_thousand")
complete_columns(data_4B,"new_tests_per_thousand")
complete_columns <- function(data,col){
data_4B = data[complete.cases(data[, col]), ]
group_4 <- group_by(data_4B,Date,continent)
summ_4 <- summarize(group_4, mean=mean(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
table_4A = table_4[complete.cases(table_4$mean), ]
new_table_D4 <- left_join(data, table_4A ,by=c("location"="continent" ,"Date"="Date"))
new_table_D4[, col] <- coalesce(new_table_D4[, col], new_table_D4$mean)
print(new_table_D4)}
complete_columns(data_4B,"new_tests_per_thousand")
complete_columns <- function(data,col){
data_4B = data[complete.cases(data[, col]), ]
group_4 <- group_by(data_4B,Date,continent)
summ_4 <- summarize(group_4, mean=mean(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
table_4A = table_4[complete.cases(table_4$mean), ]
new_table_D4 <- left_join(data, table_4A ,by=c("location"="continent" ,"Date"="Date"))
new_table_D4[, col] <- coalesce(new_table_D4[, col], new_table_D4$mean)
return(new_table_D4)}
e = complete_columns(data_4B,"new_tests_per_thousand")
View(e)
create_plot <- function(data,string){
clean_data = data[complete.cases(data[, string]),]
data_for_plot_location <- (filter(clean_data ,location == "Africa" |location == "Asia" | location == "Europe" | location =="North America"| location =="Oceania" | location =="South America"))
p <- ggplot(data_for_plot_location, aes(x = Date, y = !!sym(string)),na.rl=TRUE)+ geom_point(aes(color = location)) + labs(x="Date", y=string)
print(p)
}
new_Data_2 <- Data
new_Data_2[new_Data_2==0] <- NA
create_plot(new_Data_2,"new_cases")
create_plot(new_Data_2,"log_new_cases_smoothed")
new_Data_2$new_cases_smoothed = log(new_Data_2$new_cases_smoothed)
names(new_Data_2)[7] <- "log_new_cases_smoothed"
create_plot(new_Data_2,"log_new_cases_smoothed")
View(new_Data_2)
new_Data_2 <- Data
new_Data_2[new_Data_2==0] <- NA
data_n_c = new_Data_2[complete.cases(data[, col]),]
new_Data_2 <- Data
new_Data_2[new_Data_2==0] <- NA
create_plot(new_Data_2,"new_cases")
new_Data_2$new_cases_smoothed = log(new_Data_2$new_cases_smoothed)
names(new_Data_2)[7] <- "log_new_cases_smoothed"
new_Data_2$new_deaths_smoothed = log(new_Data_2$new_deaths_smoothed)
names(new_Data_2)[10] <- "log_new_deaths_smoothed"
new_Data_2$new_vaccinations_smoothed = log(new_Data_2$new_vaccinations_smoothed)
names(new_Data_2)[39] <- "log_new_vaccinations_smoothed"
new_Data_2 <- Data
new_Data_2[new_Data_2==0] <- NA
create_plot(new_Data_2,"new_cases")
new_Data_2$new_cases_smoothed = log(new_Data_2$new_cases_smoothed)
names(new_Data_2)[7] <- "log_new_cases_smoothed"
new_Data_2$new_deaths_smoothed = log(new_Data_2$new_deaths_smoothed)
names(new_Data_2)[10] <- "log_new_deaths_smoothed"
new_Data_2$new_vaccinations_smoothed = log(new_Data_2$new_vaccinations_smoothed)
names(new_Data_2)[39] <- "log_new_vaccinations_smoothed"
create_plot(new_Data_2,"log_new_cases_smoothed")
create_plot(data_s_n_d,"log_new_deaths_smoothed")
create_plot(data_s_n_v,"log_new_vaccinations_smoothed")
complete_columns <- function(data,col){
data_4B = data[complete.cases(data[, col]), ]
group_4 <- group_by(data_4B,Date,continent)
summ_4 <- summarize(group_4, mean=mean(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
new_table_D4 <- left_join(data, table_4A ,by=c("location"="continent" ,"Date"="Date"))
new_table_D4[, col] <- coalesce(new_table_D4[, col], new_table_D4$mean)
return(new_table_D4)}
e = complete_columns(data_4B,"new_tests_per_thousand")
complete_columns <- function(data,col){
data_4B = data[complete.cases(data[, col]), ]
group_4 <- group_by(data_4B,Date,continent)
summ_4 <- summarize(group_4, mean=mean(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
new_table_D4 <- left_join(data, table_4 ,by=c("location"="continent" ,"Date"="Date"))
new_table_D4[, col] <- coalesce(new_table_D4[, col], new_table_D4$mean)
return(new_table_D4)}
e = complete_columns(data_4B,"new_tests_per_thousand")
View(e)
complete_columns <- function(data,col){
group_4 <- group_by(data,Date,continent)
summ_4 <- summarize(group_4, mean=mean(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
new_table_D4 <- left_join(data, table_4 ,by=c("location"="continent" ,"Date"="Date"))
new_table_D4[, col] <- coalesce(new_table_D4[, col], new_table_D4$mean)
return(new_table_D4)}
e = complete_columns(data_4B,"new_tests_per_thousand")
View(e)
complete_columns <- function(data,col){
group_4 <- group_by(data,Date,continent)
summ_4 <- summarize(group_4, mean=mean(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
new_table_D4 <- left_join(data, table_4 ,by=c("location"="continent" ,"Date"="Date"))
new_table_D4[, col] <- coalesce(new_table_D4[, col], new_table_D4$mean)
return(new_table_D4)}
e = complete_columns(data_4B,"new_tests_per_thousand")
View(e)
e = complete_columns(Data,"new_tests_per_thousand")
View(e)
complete_columns <- function(data,col){
data_4B = data[complete.cases(data[, col]), ]
group_4 <- group_by(data_4B,Date,continent)
summ_4 <- summarize(group_4, mean=mean(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
new_table_D4 <- left_join(data, table_4 ,by=c("location"="continent" ,"Date"="Date"))
new_table_D4[, col] <- coalesce(new_table_D4[, col], new_table_D4$mean)
return(new_table_D4)}
e = complete_columns(Data,"new_tests_per_thousand")
View(e)
complete_columns <- function(data,col){
data_4A = data[complete.cases(data[, col]), ]
group_4 <- group_by(data_4A,Date,continent)
summ_4 <- summarize(group_4, mean=mean(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
new_table_D4 <- left_join(data, table_4 ,by=c("location"="continent" ,"Date"="Date"))
new_table_D4[, col] <- coalesce(new_table_D4[, col], new_table_D4$mean)
return(new_table_D4)}
new_Data_4B <- complete_columns(Data,"new_tests_per_thousand")
new_Data_4B <- complete_columns(Data,"new_tests_per_thousand")
new_Data_4B
View(new_Data_4B)
new_Data_4B <- complete_columns(Data,"new_tests_per_thousand")
new_Data_4B$new_tests_per_thousand = log(new_Data_4B$new_tests_per_thousand)
names(new_Data_4B)[28] <- "log_new_tests_per_thousand"
create_plot(new_Data_2,"log_new_tests_per_thousand")
create_plot <- function(data,string){
clean_data = data[complete.cases(data[, string]),]
data_for_plot_location <- (filter(clean_data ,location == "Africa" |location == "Asia" | location == "Europe" | location =="North America"| location =="Oceania" | location =="South America"))
p <- ggplot(data_for_plot_location, aes(x = Date, y = !!sym(string)),na.rl=TRUE)+ geom_point(aes(color = location)) + labs(x="Date", y=string)
print(p)
}
new_Data_2 <- Data
new_Data_2[new_Data_2==0] <- NA
create_plot(new_Data_2,"new_cases")
new_Data_2$new_cases_smoothed = log(new_Data_2$new_cases_smoothed)
names(new_Data_2)[7] <- "log_new_cases_smoothed"
new_Data_2$new_deaths_smoothed = log(new_Data_2$new_deaths_smoothed)
names(new_Data_2)[10] <- "log_new_deaths_smoothed"
new_Data_2$new_vaccinations_smoothed = log(new_Data_2$new_vaccinations_smoothed)
names(new_Data_2)[39] <- "log_new_vaccinations_smoothed"
create_plot(new_Data_2,"log_new_cases_smoothed")
create_plot(data_s_n_d,"log_new_deaths_smoothed")
create_plot(data_s_n_v,"log_new_vaccinations_smoothed")
new_Data_4B <- complete_columns(Data,"new_tests_per_thousand")
new_Data_4B$new_tests_per_thousand = log(new_Data_4B$new_tests_per_thousand)
names(new_Data_4B)[28] <- "log_new_tests_per_thousand"
create_plot(new_Data_4B,"log_new_tests_per_thousand")
new_Data_4B$new_tests_per_thousand
new_Data_4B <- complete_columns(Data,"new_tests_per_thousand")
new_Data_4B[new_Data_4B==0] <- NA
new_Data_4B$new_tests_per_thousand = log(new_Data_4B$new_tests_per_thousand)
names(new_Data_4B)[28] <- "log_new_tests_per_thousand"
create_plot(new_Data_4B,"log_new_tests_per_thousand")
new_Data_4B <- complete_columns(Data,"new_tests_per_thousand")
new_Data_4B[new_Data_4B==0] <- NA
new_Data_4B$new_tests_per_thousand = log(new_Data_4B$new_tests_per_thousand)
new_Data_4B$new_tests_per_thousand
names(new_Data_4B)[28] <- "log_new_tests_per_thousand"
new_Data_4B
View(new_Data_4B)
new_Data_4B <- complete_columns(Data,"new_tests_per_thousand")
new_Data_4B[new_Data_4B==0] <- NA
new_Data_4B$new_tests_per_thousand = log(new_Data_4B$new_tests_per_thousand)
names(new_Data_4B)[29] <- "log_new_tests_per_thousand"
create_plot(new_Data_4B,"log_new_tests_per_thousand")
NewData_10A <-  Data[complete.cases(Data$new_cases_smoothed),]
NewData_10B <-  NewData_10A[complete.cases(NewData_10A$new_cases_smoothed),]
NewData_10C <-  NewData_10B[complete.cases(NewData_10B$people_vaccinated_per_hundred),]
data_10f_B <-(filter(NewData_10C,Date == "2021-04-23"))
group_10 <- group_by(NewData_10C, location)
summ_10 <- summarize(group_10, max_new_cases = (new_cases_smoothed[which.max(new_cases_smoothed)]))
NewData_10A <-  Data[complete.cases(Data$new_cases_smoothed),]
NewData_10B <-  NewData_10A[complete.cases(NewData_10A$new_cases_smoothed),]
NewData_10C <-  NewData_10B[complete.cases(NewData_10B$people_vaccinated_per_hundred),]
data_10f_B <-(filter(NewData_10C,Date == "2021-04-23",Date == "2021-04-1"))
group_10 <- group_by(NewData_10C, location)
summ_10 <- summarize(group_10, max_new_cases = (new_cases_smoothed[which.max(new_cases_smoothed)]))
NewData_10A <-  Data[complete.cases(Data$new_cases_smoothed),]
NewData_10B <-  NewData_10A[complete.cases(NewData_10A$new_cases_smoothed),]
NewData_10C <-  NewData_10B[complete.cases(NewData_10B$people_vaccinated_per_hundred),]
data_10f_C <-(filter(NewData_10C,Date == "2021-04-23"))
data_10f_V <-(filter(NewData_10C,Date == "2021-04-1"))
group_10 <- group_by(NewData_10C, location)
summ_10 <- summarize(group_10, max_new_cases = (new_cases_smoothed[which.max(new_cases_smoothed)]))
NewData_10A <-  Data[complete.cases(Data$new_cases_smoothed),]
NewData_10B <-  NewData_10A[complete.cases(NewData_10A$people_vaccinated_per_hundred),]
data_10f_B <-(filter(NewData_10B,Date == "2021-04-23"))
data_10f_C <-select(data_10f_B,location,Date,new_cases_smoothed)
data_10f_B1 <-(filter(NewData_10B,Date == "2021-04-1"))
data_10f_V <-select(data_10f_B1,location,Date,people_vaccinated_per_hundred)
group_10 <- group_by(NewData_10B, location)
summ_10 <- summarize(group_10, max_new_cases = (new_cases_smoothed[which.max(new_cases_smoothed)]))
new_table_D10 <- left_join(summ_10,data_10f_C, data_10f_V ,by=c("location")
View(new_table)
NewData_10A <-  Data[complete.cases(Data$new_cases_smoothed),]
NewData_10B <-  NewData_10A[complete.cases(NewData_10A$people_vaccinated_per_hundred),]
data_10f_B <-(filter(NewData_10B,Date == "2021-04-23"))
data_10f_C <-select(data_10f_B,location,Date,new_cases_smoothed)
data_10f_B1 <-(filter(NewData_10B,Date == "2021-04-1"))
data_10f_V <-select(data_10f_B1,location,Date,people_vaccinated_per_hundred)
group_10 <- group_by(NewData_10B, location)
summ_10 <- summarize(group_10, max_new_cases = (new_cases_smoothed[which.max(new_cases_smoothed)]))
new_table_D10 <- left_join(summ_10,data_10f_C, data_10f_V ,by=c("location"))
View(new_table_D10)
NewData_10A <-  Data[complete.cases(Data$new_cases_smoothed),]
NewData_10B <-  NewData_10A[complete.cases(NewData_10A$people_vaccinated_per_hundred),]
data_10f_B <-(filter(NewData_10B,Date == "2021-04-23"))
data_10f_C <-select(data_10f_B,location,new_cases_smoothed)
data_10f_B1 <-(filter(NewData_10B,Date == "2021-04-1"))
data_10f_V <-select(data_10f_B1,location,people_vaccinated_per_hundred)
group_10 <- group_by(NewData_10B, location)
summ_10 <- summarize(group_10, max_new_cases = (new_cases_smoothed[which.max(new_cases_smoothed)]))
new_table_D10 <- left_join(summ_10,data_10f_C,by=c("location"))
new_table_D10A <- left_join(new_table_D10,data_10f_V,by=c("location"))
new_table_D10A
View(new_table_D10A)
NewData_10A <-  Data[complete.cases(Data$new_cases_smoothed),]
data_10f_B <-(filter(NewData_10A,Date == "2021-04-23"))
data_10f_C <-select(data_10f_B,location,new_cases_smoothed)
data_10f_B1 <-(filter(NewData_10A,Date == "2021-04-1"))
data_10f_V <-select(data_10f_B1,location,people_vaccinated_per_hundred)
group_10 <- group_by(NewData_10A, location)
summ_10 <- summarize(group_10, max_new_cases = (new_cases_smoothed[which.max(new_cases_smoothed)]))
new_table_D10 <- left_join(summ_10,data_10f_C,by=c("location"))
new_table_D10A <- left_join(new_table_D10,data_10f_V,by=c("location"))
new_table_D10B <-  NewData_10A[complete.cases(new_table_D10A$people_vaccinated_per_hundred),]
new_table_D10C <-  NewData_10B[complete.cases(new_table_D10B$new_cases_smoothed),]
new_table_D10C
View(new_table_D10C)
NewData_10A <-  Data[complete.cases(Data$new_cases_smoothed),]
data_10f_B <-(filter(NewData_10A,Date == "2021-04-23"))
data_10f_C <-select(data_10f_B,location,new_cases_smoothed)
data_10f_B1 <-(filter(NewData_10A,Date == "2021-04-1"))
data_10f_V <-select(data_10f_B1,location,people_vaccinated_per_hundred)
group_10 <- group_by(NewData_10A, location)
summ_10 <- summarize(group_10, max_new_cases = (new_cases_smoothed[which.max(new_cases_smoothed)]))
new_table_D10 <- left_join(summ_10,data_10f_C,by=c("location"))
new_table_D10A <- left_join(new_table_D10,data_10f_V,by=c("location"))
new_table_D10B <-  new_table_D10A[complete.cases(new_table_D10A$people_vaccinated_per_hundred),]
new_table_D10C <-  new_table_D10B[complete.cases(new_table_D10B$new_cases_smoothed),]
View(new_table_D10C)
NewData_10A <-  Data[complete.cases(Data$new_cases_smoothed),]
data_10f_B <-(filter(NewData_10A,Date == "2021-04-23"))
data_10f_C <-select(data_10f_B,location,new_cases_smoothed)
data_10f_B1 <-(filter(NewData_10A,Date == "2021-04-1"))
data_10f_V <-select(data_10f_B1,location,people_vaccinated_per_hundred)
group_10 <- group_by(NewData_10A, location)
summ_10 <- summarize(group_10, max_new_cases = (new_cases_smoothed[which.max(new_cases_smoothed)]))
new_table_D10 <- left_join(summ_10,data_10f_C,by=c("location"))
new_table_D10A <- left_join(new_table_D10,data_10f_V,by=c("location"))
new_table_D10B <-  new_table_D10A[complete.cases(new_table_D10A$people_vaccinated_per_hundred),]
new_table_D10C <-  new_table_D10B[complete.cases(new_table_D10B$new_cases_smoothed),]
max_new_cases <- new_table_D10C$max_new_cases
current_new_cases <- new_table_D10C$new_cases_smoothed
max_ratio_now_smo_cases <- (current_new_cases/max_new_cases)
New_Data_Q_10 <- cbind(new_table_D10C, max_ratio_now_smo_cases)
View(New_Data_Q_10)
New_Data_Q_10_A <-select(New_Data_Q_10,location,people_vaccinated_per_hundred,max_ratio_now_smo_cases)
View(New_Data_Q_10_A)
NewData_10A <-  Data[complete.cases(Data$new_cases_smoothed),]
data_10f_B <-(filter(NewData_10A,Date == "2021-04-23"))
data_10f_C <-select(data_10f_B,location,new_cases_smoothed)
data_10f_B1 <-(filter(NewData_10A,Date == "2021-04-1"))
data_10f_V <-select(data_10f_B1,location,people_vaccinated_per_hundred)
group_10 <- group_by(NewData_10A, location)
summ_10 <- summarize(group_10, max_new_cases = (new_cases_smoothed[which.max(new_cases_smoothed)]))
new_table_D10 <- left_join(summ_10,data_10f_C,by=c("location"))
new_table_D10A <- left_join(new_table_D10,data_10f_V,by=c("location"))
new_table_D10B <-  new_table_D10A[complete.cases(new_table_D10A$people_vaccinated_per_hundred),]
new_table_D10C <-  new_table_D10B[complete.cases(new_table_D10B$new_cases_smoothed),]
max_new_cases <- new_table_D10C$max_new_cases
current_new_cases <- new_table_D10C$new_cases_smoothed
max_ratio_now_smo_cases <- (current_new_cases/max_new_cases)
New_Data_Q_10 <- cbind(new_table_D10C, max_ratio_now_smo_cases)
New_Data_Q_10_A <-select(New_Data_Q_10,location,people_vaccinated_per_hundred,max_ratio_now_smo_cases)
New_Data_Q_10_A$max_ratio_now_smo_cases = log(New_Data_Q_10_A$max_ratio_now_smo_cases)
names(new_Data_2)[3] <- "log_max_ratio_now_smo_cases"
New_Data_Q_10_A$people_vaccinated_per_hundred = log(New_Data_Q_10_A$people_vaccinated_per_hundred)
names(new_Data_2)[2] <- "log_people_vaccinated_per_hundred"
par(mfcol = c(1,1), mar = c(4,4,3,3))
plot(New_Data_Q_10_A$log_max_ratio_now_smo_cases,New_Data_Q_10_A$log_people_vaccinated_per_hundred,pch=20,cex = 0.5, xlab = "log_max_ratio_now_smo_cases", ylab = "log_people_vaccinated_per_hundred",
cex.axis =1.4, cex.lab=1.4)
NewData_10A <-  Data[complete.cases(Data$new_cases_smoothed),]
data_10f_B <-(filter(NewData_10A,Date == "2021-04-23"))
data_10f_C <-select(data_10f_B,location,new_cases_smoothed)
data_10f_B1 <-(filter(NewData_10A,Date == "2021-04-1"))
data_10f_V <-select(data_10f_B1,location,people_vaccinated_per_hundred)
group_10 <- group_by(NewData_10A, location)
summ_10 <- summarize(group_10, max_new_cases = (new_cases_smoothed[which.max(new_cases_smoothed)]))
new_table_D10 <- left_join(summ_10,data_10f_C,by=c("location"))
new_table_D10A <- left_join(new_table_D10,data_10f_V,by=c("location"))
new_table_D10B <-  new_table_D10A[complete.cases(new_table_D10A$people_vaccinated_per_hundred),]
new_table_D10C <-  new_table_D10B[complete.cases(new_table_D10B$new_cases_smoothed),]
max_new_cases <- new_table_D10C$max_new_cases
current_new_cases <- new_table_D10C$new_cases_smoothed
max_ratio_now_smo_cases <- (current_new_cases/max_new_cases)
New_Data_Q_10 <- cbind(new_table_D10C, max_ratio_now_smo_cases)
New_Data_Q_10_A <-select(New_Data_Q_10,location,people_vaccinated_per_hundred,max_ratio_now_smo_cases)
New_Data_Q_10_A$max_ratio_now_smo_cases = log(New_Data_Q_10_A$max_ratio_now_smo_cases)
names(new_Data_2)[3] <- "log_max_ratio_now_smo_cases"
New_Data_Q_10_A$people_vaccinated_per_hundred = log(New_Data_Q_10_A$people_vaccinated_per_hundred)
names(new_Data_2)[2] <- "log_people_vaccinated_per_hundred"
New_Data_Q_10_A
View(New_Data_Q_10_A)
NewData_10A <-  Data[complete.cases(Data$new_cases_smoothed),]
data_10f_B <-(filter(NewData_10A,Date == "2021-04-23"))
data_10f_C <-select(data_10f_B,location,new_cases_smoothed)
data_10f_B1 <-(filter(NewData_10A,Date == "2021-04-1"))
data_10f_V <-select(data_10f_B1,location,people_vaccinated_per_hundred)
group_10 <- group_by(NewData_10A, location)
summ_10 <- summarize(group_10, max_new_cases = (new_cases_smoothed[which.max(new_cases_smoothed)]))
new_table_D10 <- left_join(summ_10,data_10f_C,by=c("location"))
new_table_D10A <- left_join(new_table_D10,data_10f_V,by=c("location"))
new_table_D10B <-  new_table_D10A[complete.cases(new_table_D10A$people_vaccinated_per_hundred),]
new_table_D10C <-  new_table_D10B[complete.cases(new_table_D10B$new_cases_smoothed),]
max_new_cases <- new_table_D10C$max_new_cases
current_new_cases <- new_table_D10C$new_cases_smoothed
max_ratio_now_smo_cases <- (current_new_cases/max_new_cases)
New_Data_Q_10 <- cbind(new_table_D10C, max_ratio_now_smo_cases)
New_Data_Q_10_A <-select(New_Data_Q_10,location,people_vaccinated_per_hundred,max_ratio_now_smo_cases)
New_Data_Q_10_A$max_ratio_now_smo_cases = log(New_Data_Q_10_A$max_ratio_now_smo_cases)
names(New_Data_Q_10_A)[3] <- "log_max_ratio_now_smo_cases"
New_Data_Q_10_A$people_vaccinated_per_hundred = log(New_Data_Q_10_A$people_vaccinated_per_hundred)
names(New_Data_Q_10_A)[2] <- "log_people_vaccinated_per_hundred"
par(mfcol = c(1,1), mar = c(4,4,3,3))
plot(New_Data_Q_10_A$log_max_ratio_now_smo_cases,New_Data_Q_10_A$log_people_vaccinated_per_hundred,pch=20,cex = 0.5, xlab = "log_max_ratio_now_smo_cases", ylab = "log_people_vaccinated_per_hundred",
cex.axis =1.4, cex.lab=1.4)
par(mfcol = c(1,1), mar = c(4,4,3,3))
plot(New_Data_Q_10_A$log_max_ratio_now_smo_cases,New_Data_Q_10_A$log_people_vaccinated_per_hundred,pch=20,cex = 0.5, xlab = "log_max_ratio_now_smo_cases", ylab = "log_people_vaccinated_per_hundred",
cex.axis =1.4, cex.lab=1.4)
pnt <- identify(x, y, plot = F)
pnt <- identify(New_Data_Q_10_A$log_max_ratio_now_smo_cases,New_Data_Q_10_A$log_people_vaccinated_per_hundred, plot = F)
plot(New_Data_Q_10_A$log_max_ratio_now_smo_cases,New_Data_Q_10_A$log_people_vaccinated_per_hundred,pch=20,cex = 0.5, xlab = "log_max_ratio_now_smo_cases", ylab = "log_people_vaccinated_per_hundred",
cex.axis =1.4, cex.lab=1.4)
pnt <- identify(New_Data_Q_10_A$log_max_ratio_now_smo_cases,New_Data_Q_10_A$log_people_vaccinated_per_hundred, plot = F)
plot(New_Data_Q_10_A$log_max_ratio_now_smo_cases,New_Data_Q_10_A$log_people_vaccinated_per_hundred,pch=20,cex = 0.5, xlab = "log_max_ratio_now_smo_cases", ylab = "log_people_vaccinated_per_hundred",
cex.axis =1.4, cex.lab=1.4,col=mycol[c("Israel","United Kingdom")] <- "red")
par(mfcol = c(1,1), mar = c(4,4,3,3))
plot(New_Data_Q_10_A$log_max_ratio_now_smo_cases,New_Data_Q_10_A$log_people_vaccinated_per_hundred,pch=20,cex = 0.5, xlab = "log_max_ratio_now_smo_cases", ylab = "log_people_vaccinated_per_hundred",
cex.axis =1.4, cex.lab=1.4,colc("Israel","United Kingdom") = "red")
par(mfcol = c(1,1), mar = c(4,4,3,3))
plot(New_Data_Q_10_A$log_max_ratio_now_smo_cases,New_Data_Q_10_A$log_people_vaccinated_per_hundred,pch=20,cex = 0.5, xlab = "log_max_ratio_now_smo_cases", ylab = "log_people_vaccinated_per_hundred",
cex.axis =1.4, cex.lab=1.4,col=c("Israel","United Kingdom") = "red")
New_Data_Q_10_A$max_ratio_now_smo_cases = log(New_Data_Q_10_A$max_ratio_now_smo_cases)
NewData_10A <-  Data[complete.cases(Data$new_cases_smoothed),]
data_10f_B <-(filter(NewData_10A,Date == "2021-04-23"))
data_10f_C <-select(data_10f_B,location,new_cases_smoothed)
data_10f_B1 <-(filter(NewData_10A,Date == "2021-04-1"))
data_10f_V <-select(data_10f_B1,location,people_vaccinated_per_hundred)
group_10 <- group_by(NewData_10A, location)
summ_10 <- summarize(group_10, max_new_cases = (new_cases_smoothed[which.max(new_cases_smoothed)]))
new_table_D10 <- left_join(summ_10,data_10f_C,by=c("location"))
new_table_D10A <- left_join(new_table_D10,data_10f_V,by=c("location"))
new_table_D10B <-  new_table_D10A[complete.cases(new_table_D10A$people_vaccinated_per_hundred),]
new_table_D10C <-  new_table_D10B[complete.cases(new_table_D10B$new_cases_smoothed),]
max_new_cases <- new_table_D10C$max_new_cases
current_new_cases <- new_table_D10C$new_cases_smoothed
max_ratio_now_smo_cases <- (current_new_cases/max_new_cases)
New_Data_Q_10 <- cbind(new_table_D10C, max_ratio_now_smo_cases)
New_Data_Q_10_A <-select(New_Data_Q_10,location,people_vaccinated_per_hundred,max_ratio_now_smo_cases)
New_Data_Q_10_A$max_ratio_now_smo_cases = log(New_Data_Q_10_A$max_ratio_now_smo_cases)
names(New_Data_Q_10_A)[3] <- "log_max_ratio_now_smo_cases"
New_Data_Q_10_A$people_vaccinated_per_hundred = log(New_Data_Q_10_A$people_vaccinated_per_hundred)
names(New_Data_Q_10_A)[2] <- "log_people_vaccinated_per_hundred"
par(mfcol = c(1,1), mar = c(4,4,3,3))
plot(New_Data_Q_10_A$log_max_ratio_now_smo_cases,New_Data_Q_10_A$log_people_vaccinated_per_hundred,pch=20,cex = 0.5, xlab = "log_max_ratio_now_smo_cases", ylab = "log_people_vaccinated_per_hundred",
cex.axis =1.4, cex.lab=1.4)
p_10 <- ggplot(data = New_Data_Q_10_A, aes(x = log_max_ratio_now_smo_cases, y = log_people_vaccinated_per_hundred))
p_10 + geom_point(data = New_Data_Q_10_A, color = "gray") +
geom_point(data = New_Data_Q_10_A[37,83], color = "red")
p_10 <- ggplot(data = New_Data_Q_10_A, aes(x = log_max_ratio_now_smo_cases, y = log_people_vaccinated_per_hundred))
p_10 + geom_point(data = New_Data_Q_10_A, color = "gray") +
geom_point(data = New_Data_Q_10_A[37,83,], color = "red")
p_10 <- ggplot(data = New_Data_Q_10_A, aes(x = log_max_ratio_now_smo_cases, y = log_people_vaccinated_per_hundred))
p_10 + geom_point(data = New_Data_Q_10_A, color = "gray")
geom_point(data = New_Data_Q_10_A[37,], color = "red")
p_10 <- ggplot(data = New_Data_Q_10_A, aes(x = log_max_ratio_now_smo_cases, y = log_people_vaccinated_per_hundred))
p_10 + geom_point(data = New_Data_Q_10_A, color = "gray") +
geom_point(data = New_Data_Q_10_A[37,], color = "red")
p_10 <- ggplot(data = New_Data_Q_10_A, aes(x = log_max_ratio_now_smo_cases, y = log_people_vaccinated_per_hundred))
p_10 + geom_point(data = New_Data_Q_10_A, color = "gray") +
geom_point(data = New_Data_Q_10_A[37,], color = "red") +
geom_point(data = New_Data_Q_10_A[83,], color = "red")
View(NewData_10A)
complete_columns <- function(data,col){
data_4A = data[complete.cases(data[, col]), ]
group_4 <- group_by(data_4A,Date,continent)
summ_4 <- summarize(group_4, sum=sum(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
new_table_D4 <- left_join(data, table_4 ,by=c("location"="continent" ,"Date"="Date"))
new_table_D4[, col] <- coalesce(new_table_D4[, col], new_table_D4$sum)
return(new_table_D4)}
new_Data_4B <- complete_columns(Data,"new_tests_smoothed")
new_Data_4B[new_Data_4B==0] <- NA
new_Data_4B$new_tests_per_thousand = log(new_Data_4B$"new_tests_smoothed")
names(new_Data_4B)[29] <- "log_new_tests_smoothed"
create_plot(new_Data_4B,"log_new_tests_smoothed")
new_Data_4B <- complete_columns(Data,"new_tests")
new_Data_4B[new_Data_4B==0] <- NA
new_Data_4B$new_tests_per_thousand = log(new_Data_4B$"new_tests")
names(new_Data_4B)[29] <- "log_new_tests"
create_plot(new_Data_4B,"log_new_test")
new_Data_4B <- complete_columns(Data,"new_tests")
new_Data_4B[new_Data_4B==0] <- NA
new_Data_4B$new_tests = log(new_Data_4B$"new_tests")
names(new_Data_4B)[29] <- "log_new_tests"
create_plot(new_Data_4B,"log_new_test")
new_Data_4B <- complete_columns(Data,"new_tests")
new_Data_4B[new_Data_4B==0] <- NA
new_Data_4B$new_tests = log(new_Data_4B$new_tests)
names(new_Data_4B)[29] <- "log_new_tests"
create_plot(new_Data_4B,"log_new_test")
new_Data_4B <- complete_columns(Data,"new_tests")
new_Data_4B[new_Data_4B==0] <- NA
new_Data_4B$new_tests = log(new_Data_4B$new_tests)
names(new_Data_4B)[29] <- "log_new_tests"
create_plot(new_Data_4B,"log_new_tests")
new_Data_4B <- complete_columns(Data,"new_tests")
View(new_Data_4B)
new_Data_4B <- complete_columns(Data,"new_tests")
new_Data_4B[new_Data_4B==0] <- NA
new_Data_4B$new_tests = log(new_Data_4B$new_tests)
new_Data_4B <- complete_columns(Data,"new_tests")
new_Data_4B[new_Data_4B==0] <- NA
new_Data_4B$new_tests = log(new_Data_4B$new_tests)
names(new_Data_4B)[26] <- "log_new_tests"
create_plot(new_Data_4B,"log_new_tests")
summary(reg_5B)
NewData_B1 <-  NewData_2[complete.cases(NewData_2$new_cases),]
NewData_B2 <-  NewData_B1[complete.cases(NewData_B1$new_deaths),]
group_loc <- group_by(NewData_B2, location)
group_summ <- summarize(group_loc, max_new_cases_date = as.Date(Date[which.max(new_cases)]),max_new_deaths_date = as.Date(Date[which.max(new_deaths)]))
new_table <- merge(NewData_4, group_summ,
by.x ="location" , by.y ="location" ,
all.x = TRUE, all.y =TRUE )
final_table <-  new_table[complete.cases(new_table$max_new_cases_date),]
final_table_5B <-  final_table[complete.cases(final_table$max_new_deaths_date),]
par(mfcol = c(1,1), mar = c(4,4,3,3))
plot(final_table_5B$max_new_cases_date,final_table_5B$max_new_deaths_date,pch=20,cex = 0.5, xlab = "max_new_cases_date", ylab = "max_new_deaths_date",cex.axis =1.4, cex.lab=1.4)
abline(lm((final_table_5B$max_new_cases_date)~final_table_5B$max_new_deaths_date),lwd=3,col="blue")
reg_5B = lm(final_table_5B$max_new_cases_date~final_table_5B$max_new_deaths_date)
complete_columns <- function(data,col){
data_4A = data[complete.cases(data[, col]), ]
group_4 <- group_by(data_4A,Date,continent)
summ_4 <- summarize(group_4, sum=sum(!!sym(col)))
table_4 <- filter(summ_4,continent != "")
new_table_D4 <- left_join(data, table_4 ,by=c("location"="continent" ,"Date"="Date"))
new_table_D4[, col] <- coalesce(new_table_D4[, col], new_table_D4$sum)
new_table_D4$mean <- NULL
return(new_table_D4)}
new_Data_4B <- complete_columns(Data,"new_tests")
new_Data_4B[new_Data_4B==0] <- NA
new_Data_4B$new_tests = log(new_Data_4B$new_tests)
names(new_Data_4B)[26] <- "log_new_tests"
create_plot(new_Data_4B,"log_new_tests")
new_Data_2 <- Data
new_Data_2[new_Data_2==0] <- NA
create_plot(new_Data_2,"new_cases")
new_Data_2$new_cases_smoothed = log(new_Data_2$new_cases_smoothed)
names(new_Data_2)[7] <- "log_new_cases_smoothed"
new_Data_2$new_deaths_smoothed = log(new_Data_2$new_deaths_smoothed)
names(new_Data_2)[10] <- "log_new_deaths_smoothed"
new_Data_2$new_vaccinations_smoothed = log(new_Data_2$new_vaccinations_smoothed)
names(new_Data_2)[39] <- "log_new_vaccinations_smoothed"
create_plot(new_Data_2,"log_new_cases_smoothed")
create_plot(new_Data_2,"log_new_deaths_smoothed")
create_plot(new_Data_2,"log_new_vaccinations_smoothed")
